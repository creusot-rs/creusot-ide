{
    "scopeName": "source.rust.embedded.creusot",
    "injectionSelector": "L:source.rust -string -comment",
    "patterns": [
        {
            "begin": "#\\[",
            "end": "\\]",
            "contentName": "meta.embedded.creusot source.creusot",
            "patterns": [
                { "match": "\\b(?:logic|trusted|opaque|bitwise_proof|check|erasure|builtin|intrinsic|open_inv_result)\\b",
                  "name": "keyword" },
                { "include": "#check-arguments" },
                { "include": "#logic-arguments" },
                { "include": "#erasure-arguments" },
                { "include": "#string" },
                { "include": "#cfg-attr-creusot" }
            ]
        }
    ],
    "repository": {
        "paren": {
            "patterns": [
                { "include": "#parentheses" },
                { "include": "#brackets" },
                { "include": "#braces" }
            ]
        },
        "check-arguments": {
            "begin": "(?<=check)\\(",
            "end": "\\)",
            "beginCaptures": {
                "0": { "name": "punctuation.section.parens.begin" }
            },
            "endCaptures": {
                "0": { "name": "punctuation.section.parens.end" }
            },
            "patterns": [
                { "include": "#paren" },
                {
                    "match": "\\b(?:terminates|ghost)\\b",
                    "name": "keyword"
                }
            ]
        },
        "logic-arguments": {
            "begin": "(?<=logic)\\(",
            "end": "\\)",
            "beginCaptures": {
                "0": { "name": "punctuation.section.parens.begin" }
            },
            "endCaptures": {
                "0": { "name": "punctuation.section.parens.end" }
            },
            "patterns": [
                {
                    "match": "\\b(?:prophetic|open|law|opaque|sealed|inline)\\b",
                    "name": "keyword"
                },
                { "include": "#open-arguments" },
                { "include": "#paren" }
            ]
        },
        "open-arguments": {
            "begin": "(?<=open)\\(",
            "end": "\\)",
            "beginCaptures": {
                "0": { "name": "punctuation.section.parens.begin" }
            },
            "endCaptures": {
                "0": { "name": "punctuation.section.parens.end" }
            },
            "patterns": [
                {
                    "match": "\\b(?:self|super|crate)\\b",
                    "name": "keyword"
                }
            ]
        },
        "erasure-arguments": {
            "begin": "(?<=erasure)\\(",
            "end": "\\)",
            "beginCaptures": {
                "0": { "name": "punctuation.section.parens.begin" }
            },
            "endCaptures": {
                "0": { "name": "punctuation.section.parens.end" }
            },
            "patterns": [
                { "include": "#paren" },
                {
                    "match": "\\b(?:private)\\b",
                    "name": "keyword"
                }
            ]
        },
        "brackets": {
            "begin": "\\[",
            "end": "\\]",
            "beginCaptures": {
                "0": { "name": "punctuation.section.bracket.begin" }
            },
            "endCaptures": {
                "0": { "name": "punctuation.section.bracket.end" }
            },
            "patterns": [
                { "include": "#paren" }
            ]
        },
        "braces": {
            "begin": "\\(",
            "end": "\\)",
            "beginCaptures": {
                "0": { "name": "punctuation.section.parens.begin" }
            },
            "endCaptures": {
                "0": { "name": "punctuation.section.parens.end" }
            },
            "patterns": [
                { "include": "#paren" }
            ]
        },
        "string": {
            "begin": "\"",
            "end": "\"",
            "patterns": [
                {
                    "match": "\\\\.",
                    "name": "constant.character.escape.untitled"
                }
            ],
            "name": "string.quoted.double"
        },
        "contract": {
            "begin": "\\b(invariant|requires|ensures|variant)\\s*\\(",
            "end": "\\)",
            "contentName": "meta.embedded.block.pearlite source.pearlite",
            "beginCaptures": {
                "1": { "name": "keyword.control" }
            },
            "patterns": [
                { "include": "source.pearlite" }
            ]
        },
        "cfg-attr-creusot": {
            "begin": "cfg_attr\\s*\\(\\s*creusot\\s*,",
            "end": "\\)",
            "patterns": [
                { "match": "\\b(?:logic|trusted|opaque|bitwise_proof|check|erasure|builtin|intrinsic|open_inv_result)\\b",
                  "name": "keyword" },
                { "include": "#check-arguments" },
                { "include": "#logic-arguments" },
                { "include": "#erasure-arguments" },
                { "include": "#contract" }
            ]
        }
    }
}
